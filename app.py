import streamlit as st
import pandas as pd
import os
from st_aggrid import AgGrid, GridOptionsBuilder, GridUpdateMode, JsCode
from io import BytesIO

# ==============================
# üìã ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
# ==============================
st.set_page_config(page_title="‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏©‡∏µ‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô", layout="wide")
st.title("üìë ‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏©‡∏µ‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô")

DATA_FILE = "sales_daily.xlsx"
COLUMNS = [
    "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠", "‡∏•‡∏≥‡∏î‡∏±‡∏ö", "‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö", "Seller",
    "‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠/‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤", "‡∏£‡∏´‡∏±‡∏™", "‡∏™‡∏µ", "Size",
    "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢", "‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î", "‡∏™‡∏∏‡∏ó‡∏ò‡∏¥", "‡∏ß.‡∏î.‡∏õ.", "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô",
    "‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á ‡∏Å‡∏ó‡∏°.", "‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á ‡∏ï‡∏à‡∏ß.", "‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡πÇ‡∏≠‡∏ô"
]

# ==============================
# üìÇ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
# ==============================
if os.path.exists(DATA_FILE) and os.path.getsize(DATA_FILE) > 0:
    df = pd.read_excel(DATA_FILE)
else:
    df = pd.DataFrame(columns=COLUMNS)

# ==============================
# üßπ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
# ==============================
def clear_form():
    for key in list(st.session_state.keys()):
        if key not in ["edit_index"]:
            del st.session_state[key]

# ==============================
# üßæ ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
# ==============================
st.subheader("üßæ ‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•")

edit_mode = "edit_index" in st.session_state and st.session_state.edit_index is not None
edit_row = df.loc[st.session_state.edit_index] if edit_mode else None

with st.form("sales_form"):
    col1, col2, col3 = st.columns(3)

    with col1:
        ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ = st.date_input("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠", value=None if not edit_mode else pd.to_datetime(edit_row["‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠"], errors="coerce"))
        ‡∏•‡∏≥‡∏î‡∏±‡∏ö = st.number_input("‡∏•‡∏≥‡∏î‡∏±‡∏ö", min_value=1, step=1, value=1 if not edit_mode else int(edit_row["‡∏•‡∏≥‡∏î‡∏±‡∏ö"]))
        ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö = st.text_input("‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö", value="" if not edit_mode else str(edit_row["‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö"]))
        Seller = st.selectbox(
            "Seller", ["shopee", "lazada", "cent", "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"],
            index=0 if not edit_mode else (
                ["shopee", "lazada", "cent", "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"].index(edit_row["Seller"])
                if edit_row["Seller"] in ["shopee", "lazada", "cent", "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"] else 0
            ),
        )
        ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ = st.text_input("‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠/‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤", value="" if not edit_mode else str(edit_row["‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠/‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤"]))

    with col2:
        ‡∏£‡∏´‡∏±‡∏™ = st.text_input("‡∏£‡∏´‡∏±‡∏™", value="" if not edit_mode else str(edit_row["‡∏£‡∏´‡∏±‡∏™"]))
        ‡∏™‡∏µ = st.text_input("‡∏™‡∏µ", value="" if not edit_mode else str(edit_row["‡∏™‡∏µ"]))
        Size = st.text_input("Size", value="" if not edit_mode else str(edit_row["Size"]))
        ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢ = st.number_input("‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢", min_value=0.0, value=0.0 if not edit_mode else float(edit_row["‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢"]))
        ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î = st.number_input("‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î", min_value=0.0, value=0.0 if not edit_mode else float(edit_row["‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î"]))
        ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ = st.number_input("‡∏™‡∏∏‡∏ó‡∏ò‡∏¥", min_value=0.0, value=0.0 if not edit_mode else float(edit_row["‡∏™‡∏∏‡∏ó‡∏ò‡∏¥"]))

    with col3:
        ‡∏ß‡∏î‡∏õ = st.date_input("‡∏ß.‡∏î.‡∏õ.", value=None if not edit_mode else pd.to_datetime(edit_row["‡∏ß.‡∏î.‡∏õ."], errors="coerce"))
        ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô = st.number_input("‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô", min_value=0.0, value=0.0 if not edit_mode else float(edit_row["‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô"]))
        ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏Å‡∏ó‡∏° = st.number_input("‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á ‡∏Å‡∏ó‡∏°.", min_value=0.0, value=0.0 if not edit_mode else float(edit_row["‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á ‡∏Å‡∏ó‡∏°."]))
        ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏ï‡∏à‡∏ß = st.number_input("‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á ‡∏ï‡∏à‡∏ß.", min_value=0.0, value=0.0 if not edit_mode else float(edit_row["‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á ‡∏ï‡∏à‡∏ß."]))

        # üîπ ‡πÅ‡∏¢‡∏Å‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡πÇ‡∏≠‡∏ô + ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏
        edit_‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡πÇ‡∏≠‡∏ô, edit_‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ = "", ""
        if edit_mode:
            txt = str(edit_row["‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡πÇ‡∏≠‡∏ô"])
            if "| ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:" in txt:
                parts = txt.split("| ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:")
                edit_‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡πÇ‡∏≠‡∏ô = parts[0].strip()
                edit_‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ = parts[1].strip()
            else:
                edit_‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡πÇ‡∏≠‡∏ô = txt

        ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡πÇ‡∏≠‡∏ô = st.text_input("‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡πÇ‡∏≠‡∏ô", value=edit_‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡πÇ‡∏≠‡∏ô if edit_mode else "")
        ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏_‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å = st.selectbox(
            "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏", ["", "‡∏Ñ‡∏∑‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤", "‡∏û‡∏±‡∏™‡∏î‡∏∏‡∏ï‡∏µ‡∏Å‡∏•‡∏±‡∏ö", "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå", "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"],
            index=0 if not edit_mode else (
                ["", "‡∏Ñ‡∏∑‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤", "‡∏û‡∏±‡∏™‡∏î‡∏∏‡∏ï‡∏µ‡∏Å‡∏•‡∏±‡∏ö", "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå", "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"].index(edit_‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏.split(":", 1)[0])
                if any(edit_‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏.startswith(opt) for opt in ["‡∏Ñ‡∏∑‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤", "‡∏û‡∏±‡∏™‡∏î‡∏∏‡∏ï‡∏µ‡∏Å‡∏•‡∏±‡∏ö", "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå", "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"]) else 0
            )
        )

        ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏_‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î = ""
        if ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏_‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å != "":
            ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏_‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î = st.text_input(
                "‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°",
                value="" if not edit_mode else (
                    edit_‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏.split(":", 1)[1].strip() if ":" in edit_‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ else ""
                )
            )

    submitted = st.form_submit_button("üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•")

if submitted:
    ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏£‡∏ß‡∏° = f" | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: {‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏_‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å}: {‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏_‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î}" if ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏_‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å else ""
    ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡πÇ‡∏≠‡∏ô_‡πÄ‡∏ï‡πá‡∏° = str(‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡πÇ‡∏≠‡∏ô) + ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏£‡∏ß‡∏°

    new_data = pd.DataFrame([[
        ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠, ‡∏•‡∏≥‡∏î‡∏±‡∏ö, ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö, Seller,
        ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤, ‡∏£‡∏´‡∏±‡∏™, ‡∏™‡∏µ, Size,
        ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢, ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î, ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥, ‡∏ß‡∏î‡∏õ, ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô,
        ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏Å‡∏ó‡∏°, ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏ï‡∏à‡∏ß, ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡πÇ‡∏≠‡∏ô_‡πÄ‡∏ï‡πá‡∏°
    ]], columns=COLUMNS)

    if edit_mode:
        df.iloc[st.session_state.edit_index] = new_data.iloc[0]
        st.session_state.edit_index = None
        st.success("‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!")
    else:
        df = pd.concat([df, new_data], ignore_index=True)
        st.success("‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!")

    df["‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠"] = pd.to_datetime(df["‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠"], errors="coerce")
    df = df.sort_values(by="‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠", ascending=True).reset_index(drop=True)
    df.to_excel(DATA_FILE, index=False)
    clear_form()
    st.rerun()

# ==============================
# üìã ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏õ‡∏∏‡πà‡∏°
# ==============================
st.subheader("üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î")

if not df.empty:
    # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏õ‡∏∏‡πà‡∏°
    df_display = df.copy()
    df_display["action"] = ""

    # ‡∏õ‡∏∏‡πà‡∏° JS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡πÄ‡∏ã‡∏•‡∏•‡πå
    cell_button = JsCode("""
        function(params) {
            return `
                <div style="text-align:center;">
                    <button style="color:white; background-color:#4CAF50; border:none; border-radius:4px; padding:2px 6px; margin-right:4px; cursor:pointer;"
                            onclick="window.editRow(${params.rowIndex})">‚úèÔ∏è</button>
                    <button style="color:white; background-color:#f44336; border:none; border-radius:4px; padding:2px 6px; cursor:pointer;"
                            onclick="window.deleteRow(${params.rowIndex})">üóëÔ∏è</button>
                </div>`;
        }
    """)

    gb = GridOptionsBuilder.from_dataframe(df_display)
    gb.configure_column("action", headerName="‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£", cellRenderer=cell_button, autoHeight=True)
    gb.configure_grid_options(domLayout='autoHeight')

    grid_response = AgGrid(
        df_display,
        gridOptions=gb.build(),
        update_mode=GridUpdateMode.NO_UPDATE,
        allow_unsafe_jscode=True,
        theme="balham",
        fit_columns_on_grid_load=True,
    )

    # ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå JS ‡∏ù‡∏±‡∏á‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏ö event ‡∏õ‡∏∏‡πà‡∏°
    st.components.v1.html("""
        <script>
        window.editRow = (index) => {
            window.parent.postMessage({type: 'edit', index: index}, '*');
        };
        window.deleteRow = (index) => {
            window.parent.postMessage({type: 'delete', index: index}, '*');
        };
        </script>
    """, height=0)

    # ‡πÉ‡∏ä‡πâ event listener ‡∏Ç‡∏≠‡∏á streamlit
    msg = st.experimental_get_query_params().get("msg", [None])[0]

else:
    st.info("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà")
